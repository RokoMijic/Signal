}
load_normalized_housing_data = function()
{
rm_norm  = load_clean_housing_data()
###### normalize stuff ########
rm_norm$price = rm_norm$price/600000
rm_norm$date_created_bucket = rm_norm$date_created_bucket/max(rm_norm$date_created_bucket)
rm_norm$num_photos = rm_norm$num_photos/max(rm_norm$num_photos)
rm_norm$num_bedrooms = rm_norm$num_bedrooms/max(rm_norm$num_bedrooms)
return(rm_norm)
}
load_just_location_price = function()
{
rm_ml = load_normalized_housing_data()
return(select(rm_ml,starts_with("lat"), starts_with("long"),starts_with("price")  ))
}
library(dplyr)
load_clean_housing_data = function()
{
rm_raw = read.csv('rightmove1_0.csv')
rm_proc = rm_raw
rm_proc = rm_proc[rm_proc$excluded == 0,]                 #lose excluded houses
rm_proc = rm_proc[rm_proc$num_bedrooms <= 50,]            #lose unreasonable numbers of bedrooms
rm_proc = rm_proc[rm_proc$num_photos <= 50,]              #lose unreasonable numbers of photos
rm_proc = rm_proc[rm_proc$date_created_bucket >= 19,]     #need to lose properties from before we started rating
row.names(rm_proc) = rm_proc$scraped_rightmove_id         #set row names
return(rm_proc)
}
load_normalized_housing_data = function()
{
rm_norm  = load_clean_housing_data()
###### normalize stuff ########
rm_norm$price = rm_norm$price/600000
rm_norm$date_created_bucket = rm_norm$date_created_bucket/max(rm_norm$date_created_bucket)
rm_norm$num_photos = rm_norm$num_photos/max(rm_norm$num_photos)
rm_norm$num_bedrooms = rm_norm$num_bedrooms/max(rm_norm$num_bedrooms)
return(rm_norm)
}
load_just_location_price = function()
{
rm_ml = load_normalized_housing_data()
return(select(rm_ml,starts_with("lat"), starts_with("long"),starts_with("price")  ))
}
rm_loc_price = load_just_location_price()
head(rm_loc_price)
install.packages(neuralnet)
install.packages("neuralnet")
library(neuralnet)
df = draw_xy(100000)
draw_xy = function(k)
{
x = runif(k, min = 0, max = 1)
y = runif(k, min = 0, max = x)
answer = data.frame(x,y)
return(answer)
}
df = draw_xy(100000)
bin_results = function(df,w=0.01)
{
N_bins = as.integer(1/w)
rows = nrow(df)
bins = rep(0,N_bins)
bincounts = rep(0,N_bins)
for( j in c(1:rows))
{
for( i in c(1:N_bins))
{
if(((i-1)*w  <=  df[[j,'y']]) & (df[[j,'y']] < i*w )  )
{
bins[[i]] = bins[[i]] + df[[j,'x']]
bincounts[[i]] = bincounts[[i]] + 1
}
}
}
averages = bins/bincounts
print(bins)
print(bincounts)
return(averages)
}
binned = bin_results(df)
df = draw_xy(10000)
bin_results = function(df,w=0.01)
{
N_bins = as.integer(1/w)
rows = nrow(df)
bins = rep(0,N_bins)
bincounts = rep(0,N_bins)
for( j in c(1:rows))
{
for( i in c(1:N_bins))
{
if(((i-1)*w  <=  df[[j,'y']]) & (df[[j,'y']] < i*w )  )
{
bins[[i]] = bins[[i]] + df[[j,'x']]
bincounts[[i]] = bincounts[[i]] + 1
}
}
}
averages = bins/bincounts
print(bins)
print(bincounts)
return(averages)
}
binned = bin_results(df)
binned
bin_results = function(df,w=0.01)
{
N_bins = as.integer(1/w)
rows = nrow(df)
bins = rep(0,N_bins)
bincounts = rep(0,N_bins)
for( j in c(1:rows))
{
for( i in c(1:N_bins))
{
if(((i-1)*w  <=  df[[j,'y']]) & (df[[j,'y']] < i*w )  )
{
bins[[i]] = bins[[i]] + df[[j,'x']]
bincounts[[i]] = bincounts[[i]] + 1
}
}
}
average_Xs = bins/bincounts
binmaxes = seq(0,1, w)
return(data.frame(binmaxes, average_Xs))
}
df = draw_xy(10000)
binned = bin_results(df)
bin_results = function(df,w=0.01)
{
N_bins = as.integer(1/w)
rows = nrow(df)
bins = rep(0,N_bins)
bincounts = rep(0,N_bins)
for( j in c(1:rows))
{
for( i in c(1:N_bins))
{
if(((i-1)*w  <=  df[[j,'y']]) & (df[[j,'y']] < i*w )  )
{
bins[[i]] = bins[[i]] + df[[j,'x']]
bincounts[[i]] = bincounts[[i]] + 1
}
}
}
average_Xs = bins/bincounts
binmaxes = seq(w,1, w)
return(data.frame(binmaxes, average_Xs))
}
binned = bin_results(df)
library(ggplot2)
ggplot2( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + geom_smooth()
library(ggplot2)
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + geom_smooth()
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function((x-1))/(ln(X)))
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function(  (x-1)/(ln(X))  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun =  (x-1)/(ln(X))  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun =  (binmaxes-1)/(ln(binmaxes))  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = function(x){ (x-1)/(ln(X))}  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = function(x){ (x-1)/(log(X))}  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = {function(x) (x-1)/(log(X))}  )
myfunc = {function(x) (x-1)/(log(X))}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = myfunc  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = dnorm  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = test  )
test <- function(x) {x ^ 2 + x + 20}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = test  )
myfunc = function(x) {(x-1)/(log(X))}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = myfunc  )
myfunc <- function(x) {(x-1)/(log(X))}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = myfunc  )
test <- function(x) {x ^ 2 + x + 20}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = test  )
myfunc <- function(x) {(x-1)/(log(x))}
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = myfunc  )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = (function(x) {x ^ 2 + x + 20}), colour = "red"   )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = (function(x) {(x-1)/(log(x))}), colour = "red"   )
ggplot( binned, aes(x = binmaxes, y = average_Xs ) ) + geom_point() + stat_function( fun = (function(x) {(x-1)/(log(x))}), colour = "red"   )
library(psych)
install.packages('psych')
library(psych)
msq
help(msq)
df = msq
head(df)
na_df = is.na(df)
head(na_df)
na_df = as.integer(is.na(df))
head(na_df)
na_df = is.na(df)
head(na_df)
num_nas = colSums(na_df)
num_nas
num_nas = sort(colSums(na_df))
num_nas
na_df = as.integer(is.na(df))
head(na_df)
na_df = is.na(df)
head(na_df)
num_nas = sort(colSums(na_df))
num_nas = colSums(na_df)
num_nas
numrows = nrow(df)
frac_nas = num_nas/numrows
frac_nas
sorted_fracs = sort(frac_nas)
sorted_fracs
sorted_fracs = sort(frac_nas, decreasing = true() )
sorted_fracs
library(dplyr)
head(df)
selected_data = select(df, active:scornful, Extraversion, Neuroticism )
head(selected_data)
selected_data[is.na(selected_data)] = colMeans(selected_data, na.rm = true)
selected_data[is.na(selected_data)] = colMeans(selected_data, na.rm =TRUE)
na.aggregate(selected_data)
library(zoo)
na.aggregate(selected_data)
library(zoo)
install.packages('zoo')
library(dplyr)
library(zoo)
na.aggregate(selected_data)
ggplot()  + geom_histogram(data = na_agg_sel, x = Extraversion)
ggplot()  + geom_histogram(data = na_agg_sel, x = 'Extraversion')
na_agg_sel = na.aggregate(selected_data)
ggplot()  + geom_histogram(data = na_agg_sel, x = 'Extraversion')
ggplot()  + geom_histogram(data = na_agg_sel, x = Extraversion)
ggplot()  + geom_histogram(data = na_agg_sel, x = 'Extraversion')
selected_data = select(df, active:scornful, Extraversion, Neuroticism )
head(selected_data)
na_agg_sel = na.aggregate(selected_data)
ggplot()  + geom_histogram(data = na_agg_sel, x = 'Extraversion')
ggplot(data = na_agg_sel, aes(x = 'Extraversion'))  + geom_histogram(binwidth = 0.1 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(binwidth = 0.1 )
head(na_agg_sel)
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count", binwidth = 1 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count" )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count" )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + stat_count(stat = "count" )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + stat_count( )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count" )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count", binwidth = 1 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_histogram(stat = "count", binwidth = 1, bins = 30 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_bar(stat = "count", binwidth = 1, bins = 30 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_bar(stat = "count",  bins = 30 )
ggplot(data = na_agg_sel, aes( 'Extraversion'))  + geom_bar(stat = "count" )
qplot(na_agg_sel$Extraversion, geom="histogram")
qplot(na_agg_sel$Neuroticism, geom="histogram")
ggplot(aes(x = "Extraversion", y = "Neuroticism")) + geom_point() + geom_smooth()
ggplot(aes(x = "Extraversion", y = "Neuroticism")) + geom_point() + geom_smooth()
ggplot(data =na_agg_sel, aes(x = "Extraversion", y = "Neuroticism")) + geom_point() + geom_smooth()
ggplot(data =na_agg_sel, aes(x = "Extraversion", y = "Neuroticism")) + geom_point()
)
na_agg_sel = na.aggregate(selected_data)
ggplot(data = na_agg_sel, aes(x = "Extraversion", y = "Neuroticism")) + geom_point()
ggplot(data = na_agg_sel ) + geom_point(aes(x = "Extraversion", y = "Neuroticism"))
ggplot( ) + geom_point(data = na_agg_sel, aes(x = "Extraversion", y = "Neuroticism"))
ggplot( ) + geom_point(data = na_agg_sel, aes(Extraversion, Neuroticism))
ggplot( ) + geom_point(data = na_agg_sel, aes(Extraversion, Neuroticism)) + geom_smooth()
ggplot( ) + geom_point(data = na_agg_sel, aes(Extraversion, Neuroticism)) + geom_smooth()
ggplot(data = na_agg_sel, aes(Extraversion, Neuroticism) ) + geom_point() + geom_smooth()
lm(Extraversion ~ -Neuroticism, data  = na_agg_sel)
lm(Extraversion ~ - . Neuroticism, data  = na_agg_sel)
lm(Extraversion ~  . -Neuroticism, data  = na_agg_sel)
lm( Neuroticism ~  . - Extraversion, data  = na_agg_sel)
extra_model = lm(Extraversion ~  . -Neuroticism, data  = na_agg_sel)
neuro_model = lm( Neuroticism ~  . - Extraversion, data  = na_agg_sel)
extra_coeffs = coefs(extra_model)
neoro_coefs = coefs(neuro_model)
extra_coeffs = coef(extra_model)
neoro_coefs = coef(neuro_model)
extra_coeffs = sort(coef(extra_model),decreasing = true  )
extra_coeffs = sort(coef(extra_model), decreasing = TRUE  )
neoro_coefs = sort(coef(neuro_model), decreasing = TRUE  )
extra_coeffs
neoro_coefs
set.seed()
runif(5)
runif(5)
runif(5)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
set.seed(1)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
runif(5)
df = read.csv("speedDatingSimple.csv")
head(df)
load(dplyr)
library(dplyr)
gender0 = filter(df, gender = 0)
gender0 = filter(df, gender == 0)
head(gender0)
gender1 =  filter(df, gender == 1)
head(gender1)
colMeans(gender0)
colMeans(gender1)
lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o )
lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o , gender0)
lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender , gender0)
g0_model =  lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender , gender0)
sort(g0_model)
sort(g0_model, coef)
coef(g0_model1)
coef(g0_model)
sort(coef(g0_model))
g1_model =  lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender , gender1)
sort(coef(g1_model))
num_rows = nrow(gender0)
rows = c(1:num_rows)
?sample
sample_size = as.integer(num_rows/2)
training_set = sample(gender0, sample_size, replace = TRUE)
gender0
training_set = sample(gender0, sample_size, replace = TRUE)
training_set
gender0
sample(gender0, 10, replace = TRUE)
sample(tbl = gender0, size = 10, replace = TRUE)
sample_n(tbl = gender0, size = 10, replace = TRUE)
training_set = sample_n(gender0, 10, replace = FALSE)
training_set
sampOnce = function(df){
train = sample_n(gender0, sample_size, replace = FALSE)
model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train)
return(coef(model))
}
coeflist = sapply(1:100, sampOnce(df))
coeflist = sapply(1:100, function(sampOnce(df)))
coeflist = sapply(1:100, function = sampOnce(df))
coeflist = sapply(1:100, function sampOnce(df))
coeflist = sapply(1:100, function(x) sampOnce(df))
head(coeflist)
train = sample_n(gender0, sample_size, replace = FALSE)
model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train)
summary(model)
cor(model)
cor(gender0)
train
df[-train]
df[-train,]
row_number(train)
row.names(train)
df[-row.names(train),]
df[row.names(train),]
df[as.integer*row.names(train)),]
df[as.integer(row.names(train)),]
df[-as.integer(row.names(train)),]
head(df[-as.integer(row.names(train)),])
df = mtcars
train_rownums = sample_n( c(1:nrows(df)),sample_size, replace = FALSE)
train_rownums = sample_n( c(1:nrow(df)),sample_size, replace = FALSE)
train_rownums = sample_n( list(1:nrow(df)),sample_size, replace = FALSE)
train_rownums = sample( list(1:nrow(df)),sample_size, replace = FALSE)
sample_size = 10
train_rownums = sample( list(1:nrow(df)),sample_size, replace = FALSE)
df = mtcars
sample_size = 10
train_rownums = sample( list(1:nrow(df)),sample_size, replace = FALSE)
train_rownums = sample( c(1:nrow(df)),sample_size, replace = FALSE)
train_rownums
test_rownums = c(1:nrows(df)[-train_rownums]
training_set
test_rownums = c(1:nrows(df))[-train_rownums]
test_rownums = c(1:nrow(df))[-train_rownums]
test_rownums
train_rownums
?predict
df
sample_size
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
df = gender0
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
?predict
sample_size = 100
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
predictions
head(predictions)
length(predictions)
R = cor(predictions, test_data$attr_o)
R
predictions
head(predictions)
head(test_data$attr_o)
R^2
sampOnce = function(df, sample_size)
{
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
R = cor(predictions, test_data$attr_o)
return(R^2)
}
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 120)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
sampOnce(gender0, 160)
ggplot(aes(predictions, test_data$attr_o)) + geom_point()
ggplot(data.frame(predictions, test_data$attr_o), aes(x =predictions, y = test_data$attr_o ) ) + geom_point()
ggplot(data.frame(predictions, test_data$attr_o), aes(x =predictions, y = test_data$attr_o ) ) + geom_point() + geom_smooth(method = 'lm')
ggplot(data.frame(predictions, test_data$attr_o), aes(y =predictions, x = test_data$attr_o ) ) + geom_point() + geom_smooth(method = 'lm')
ggplot(data.frame(predictions, test_data$attr_o), aes(y =predictions,  = test_data$attr_o ) ) + geom_point() + geom_smooth(method = 'lm')
ggplot(data.frame(predictions, test_data$attr_o), aes(y =predictions,  = test_data$attr_o ) ) + geom_point() + geom_smooth(method = 'lm')
ggplot(data.frame(predictions, test_data$attr_o), aes(x =predictions, y = test_data$attr_o ) ) + geom_point() + geom_smooth(method = 'lm')
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
R = cor(predictions, test_data$attr_o)
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
predictions = predict(trained_model, test_data )
R = cor(predictions, test_data$attr_o)
R
summary(trained_model)
train_rownums = sample( c(1:nrow(df)), sample_size, replace = FALSE)
test_rownums = c(1:nrow(df))[-train_rownums]
train_data = df[train_rownums,]
test_data = df[test_rownums,]
trained_model = lm(attr_o ~ .-sinc_o -intel_o -fun_o -amb_o -X -gender,train_data)
summary(trained_model)
predictions = predict(trained_model, test_data )
R = cor(predictions, test_data$attr_o)
R
